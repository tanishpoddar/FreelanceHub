{% extends "base.html" %}

{% block title %}{{ portfolio.title }} - {{ portfolio.user.first_name }} {{ portfolio.user.last_name }} - Portfolio{% endblock %}
{% block description %}{{ portfolio.bio[:160] if portfolio.bio else 'Professional portfolio showcasing skills and projects.' }}{% endblock %}
{% block keywords %}{{ portfolio.user.first_name }}, {{ portfolio.user.last_name }}, portfolio, freelance, {% if portfolio.skills %}{% for skill in portfolio.skills[:5] %}{{ skill.name }}, {% endfor %}{% endif %}professional{% endblock %}

{% block og_title %}{{ portfolio.title }} - {{ portfolio.user.first_name }} {{ portfolio.user.last_name }}{% endblock %}
{% block og_description %}{{ portfolio.bio[:160] if portfolio.bio else 'Professional portfolio showcasing skills and projects.' }}{% endblock %}
{% block og_image %}{% if portfolio.profile_image %}{{ request.url_root.rstrip('/') }}{{ portfolio.profile_image }}{% else %}{{ url_for('static', filename='images/og-image.jpg', _external=True) }}{% endif %}{% endblock %}

{% block twitter_title %}{{ portfolio.title }} - {{ portfolio.user.first_name }} {{ portfolio.user.last_name }}{% endblock %}
{% block twitter_description %}{{ portfolio.bio[:160] if portfolio.bio else 'Professional portfolio showcasing skills and projects.' }}{% endblock %}
{% block twitter_image %}{% if portfolio.profile_image %}{{ request.url_root.rstrip('/') }}{{ portfolio.profile_image }}{% else %}{{ url_for('static', filename='images/twitter-card.jpg', _external=True) }}{% endif %}{% endblock %}

{% block content %}
<div class="bg-white">
    <!-- Hero Section -->
    <div class="bg-gradient-to-r from-primary-600 to-primary-700 text-white">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-16">
            <div class="grid grid-cols-1 lg:grid-cols-3 gap-8 items-center">
                <div class="lg:col-span-2">
                    <h1 class="text-4xl font-bold mb-4">{{ portfolio.title }}</h1>
                    <p class="text-xl mb-6 text-primary-100">{{ portfolio.bio }}</p>
                    <div class="flex flex-wrap gap-4">
                        {% if portfolio.location %}
                        <div class="flex items-center text-primary-100">
                            <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M5.05 4.05a7 7 0 119.9 9.9L10 18.9l-4.95-4.95a7 7 0 010-9.9zM10 11a2 2 0 100-4 2 2 0 000 4z" clip-rule="evenodd"/>
                            </svg>
                            {{ portfolio.location }}
                        </div>
                        {% endif %}
                        {% if portfolio.website %}
                        <a href="{{ portfolio.website }}" target="_blank" class="flex items-center text-primary-100 hover:text-white">
                            <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M12.586 4.586a2 2 0 112.828 2.828l-3 3a2 2 0 01-2.828 0 1 1 0 00-1.414 1.414 4 4 0 005.656 0l3-3a4 4 0 00-5.656-5.656l-1.5 1.5a1 1 0 101.414 1.414l1.5-1.5zm-5 5a2 2 0 012.828 0 1 1 0 101.414-1.414 4 4 0 00-5.656 0l-3 3a4 4 0 105.656 5.656l1.5-1.5a1 1 0 10-1.414-1.414l-1.5 1.5a2 2 0 11-2.828-2.828l3-3z" clip-rule="evenodd"/>
                            </svg>
                            Website
                        </a>
                        {% endif %}
                        {% if portfolio.linkedin %}
                        <a href="{{ portfolio.linkedin }}" target="_blank" class="flex items-center text-primary-100 hover:text-white">
                            <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                                <path d="M16.338 16.338H13.67V12.16c0-.995-.017-2.277-1.387-2.277-1.39 0-1.601 1.086-1.601 2.207v4.248H8.014v-8.59h2.559v1.174h.037c.356-.675 1.227-1.387 2.526-1.387 2.703 0 3.203 1.778 3.203 4.092v4.711zM5.005 6.575a1.548 1.548 0 11-.003-3.096 1.548 1.548 0 01.003 3.096zm-1.337 9.763H6.34v-8.59H3.667v8.59zM17.668 1H2.328C1.595 1 1 1.581 1 2.298v15.403C1 18.418 1.595 19 2.328 19h15.34c.734 0 1.332-.582 1.332-1.299V2.298C19 1.581 18.402 1 17.668 1z"/>
                            </svg>
                            LinkedIn
                        </a>
                        {% endif %}
                        {% if portfolio.github %}
                        <a href="{{ portfolio.github }}" target="_blank" class="flex items-center text-primary-100 hover:text-white">
                            <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                                <path fill-rule="evenodd" d="M10 0C4.477 0 0 4.484 0 10.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0110 4.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.203 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.942.359.31.678.921.678 1.856 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.019 10.019 0 0020 10.017C20 4.484 15.522 0 10 0z" clip-rule="evenodd"/>
                            </svg>
                            GitHub
                        </a>
                        {% endif %}
                    </div>
                </div>
                <div class="flex justify-center lg:justify-end">
                    {% if portfolio.profile_image %}
                    <img src="{{ portfolio.profile_image }}" alt="{{ portfolio.title }}" 
                         class="w-48 h-48 rounded-full object-cover border-4 border-white shadow-lg">
                    {% else %}
                    <div class="w-48 h-48 rounded-full bg-primary-500 flex items-center justify-center border-4 border-white shadow-lg">
                        <span class="text-6xl font-bold text-white">{{ portfolio.user.first_name[0] }}{{ portfolio.user.last_name[0] }}</span>
                    </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>

    <!-- Contact Button -->
    <div class="bg-gray-50 border-b">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4">
            <div class="flex justify-center">
                <button onclick="openContactModal()" 
                        class="bg-primary-600 hover:bg-primary-700 text-white px-8 py-3 rounded-lg font-medium shadow-lg hover:shadow-xl transition duration-300">
                    Get In Touch
                </button>
            </div>
        </div>
    </div>

    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12">
        <!-- Projects Section -->
        <section class="mb-16">
            <h2 class="text-3xl font-bold text-gray-900 mb-8 text-center">Featured Projects</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                {% for project in portfolio.projects.order_by('order_index').all() %}
                <div class="bg-white rounded-lg shadow-lg overflow-hidden hover:shadow-xl transition duration-300">
                    {% if project.image_url %}
                    <img src="{{ project.image_url }}" alt="{{ project.title }}" 
                         class="w-full h-48 object-cover">
                    {% else %}
                    <div class="w-full h-48 bg-gradient-to-br from-primary-400 to-primary-600 flex items-center justify-center">
                        <svg class="w-16 h-16 text-white" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M4 3a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V5a2 2 0 00-2-2H4zm12 12H4l4-8 3 6 2-4 3 6z" clip-rule="evenodd"/>
                        </svg>
                    </div>
                    {% endif %}
                    <div class="p-6">
                        <h3 class="text-xl font-semibold text-gray-900 mb-2">{{ project.title }}</h3>
                        <p class="text-gray-600 mb-4">{{ project.description }}</p>
                        {% if project.technologies %}
                        <div class="flex flex-wrap gap-2 mb-4">
                            {% for tech in project.technologies.split(',') %}
                            <span class="bg-primary-100 text-primary-800 text-xs px-2 py-1 rounded-full">{{ tech.strip() }}</span>
                            {% endfor %}
                        </div>
                        {% endif %}
                        <div class="flex space-x-3">
                            {% if project.project_url %}
                            <a href="{{ project.project_url }}" target="_blank" 
                               class="text-primary-600 hover:text-primary-700 font-medium text-sm">
                                View Project
                            </a>
                            {% endif %}
                            {% if project.github_url %}
                            <a href="{{ project.github_url }}" target="_blank" 
                               class="text-gray-600 hover:text-gray-700 font-medium text-sm">
                                View Code
                            </a>
                            {% endif %}
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
        </section>

        <!-- Skills Section -->
        <section class="mb-16">
            <h2 class="text-3xl font-bold text-gray-900 mb-8 text-center">Skills & Expertise</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                {% set categories = portfolio.skills.order_by('category').all() | groupby('category') %}
                {% for category, skills in categories %}
                <div class="bg-white rounded-lg shadow-lg p-6">
                    <h3 class="text-xl font-semibold text-gray-900 mb-4">{{ category }}</h3>
                    <div class="space-y-3">
                        {% for skill in skills %}
                        <div>
                            <div class="flex justify-between items-center mb-1">
                                <span class="text-gray-700 font-medium">{{ skill.name }}</span>
                                <span class="text-sm text-gray-500">{{ skill.level }}</span>
                            </div>
                            <div class="w-full bg-gray-200 rounded-full h-2">
                                {% set level_percent = {'Beginner': 25, 'Intermediate': 50, 'Advanced': 75, 'Expert': 100} %}
                                <div class="bg-primary-600 h-2 rounded-full" style="width: {{ level_percent.get(skill.level, 50) }}%"></div>
                            </div>
                        </div>
                        {% endfor %}
                    </div>
                </div>
                {% endfor %}
            </div>
        </section>

        <!-- Testimonials Section -->
        {% if portfolio.testimonials.count() > 0 %}
        <section class="mb-16">
            <h2 class="text-3xl font-bold text-gray-900 mb-8 text-center">What Clients Say</h2>
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                {% for testimonial in portfolio.testimonials.order_by('order_index').all() %}
                <div class="bg-white rounded-lg shadow-lg p-6">
                    <div class="flex items-center mb-4">
                        {% if testimonial.client_image %}
                        <img src="{{ testimonial.client_image }}" alt="{{ testimonial.client_name }}" 
                             class="w-12 h-12 rounded-full object-cover mr-4">
                        {% else %}
                        <div class="w-12 h-12 rounded-full bg-primary-500 flex items-center justify-center mr-4">
                            <span class="text-white font-bold">{{ testimonial.client_name[0] }}</span>
                        </div>
                        {% endif %}
                        <div>
                            <h4 class="font-semibold text-gray-900">{{ testimonial.client_name }}</h4>
                            <p class="text-sm text-gray-600">{{ testimonial.client_company }}</p>
                            {% if testimonial.client_position %}
                            <p class="text-xs text-gray-500">{{ testimonial.client_position }}</p>
                            {% endif %}
                        </div>
                    </div>
                    <div class="flex items-center mb-3">
                        {% for i in range(testimonial.rating) %}
                        <svg class="w-4 h-4 text-yellow-400" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M9.049 2.927c.3-.921 1.603-.921 1.902 0l1.07 3.292a1 1 0 00.95.69h3.462c.969 0 1.371 1.24.588 1.81l-2.8 2.034a1 1 0 00-.364 1.118l1.07 3.292c.3.921-.755 1.688-1.54 1.118l-2.8-2.034a1 1 0 00-1.175 0l-2.8 2.034c-.784.57-1.838-.197-1.539-1.118l1.07-3.292a1 1 0 00-.364-1.118L2.98 8.72c-.783-.57-.38-1.81.588-1.81h3.461a1 1 0 00.951-.69l1.07-3.292z"/>
                        </svg>
                        {% endfor %}
                    </div>
                    <p class="text-gray-700 italic">"{{ testimonial.testimonial_text }}"</p>
                </div>
                {% endfor %}
            </div>
        </section>
        {% endif %}

        <!-- Stats Section -->
        <section class="bg-gray-50 rounded-lg p-8">
            <h2 class="text-3xl font-bold text-gray-900 mb-8 text-center">Portfolio Stats</h2>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8 text-center">
                <div>
                    <div class="text-4xl font-bold text-primary-600 mb-2">{{ portfolio.view_count }}</div>
                    <div class="text-gray-600">Portfolio Views</div>
                </div>
                <div>
                    <div class="text-4xl font-bold text-primary-600 mb-2">{{ portfolio.projects.count() }}</div>
                    <div class="text-gray-600">Projects Completed</div>
                </div>
                <div>
                    <div class="text-4xl font-bold text-primary-600 mb-2">{{ portfolio.testimonials.count() }}</div>
                    <div class="text-gray-600">Client Testimonials</div>
                </div>
            </div>
        </section>
    </div>
</div>

<!-- Contact Modal -->
<div id="contactModal" class="fixed inset-0 bg-gray-600 bg-opacity-50 hidden z-50">
    <div class="flex items-center justify-center min-h-screen p-4">
        <div class="bg-white rounded-lg max-w-md w-full p-6">
            <h3 class="text-lg font-medium text-gray-900 mb-4">Get In Touch</h3>
            <form method="POST" action="{{ url_for('portfolio.send_inquiry', portfolio_id=portfolio.id) }}">
                <div class="space-y-4">
                    <div>
                        <label for="name" class="block text-sm font-medium text-gray-700">Your Name</label>
                        <input type="text" name="name" id="name" required 
                               class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500">
                    </div>
                    <div>
                        <label for="email" class="block text-sm font-medium text-gray-700">Email</label>
                        <input type="email" name="email" id="email" required 
                               class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500">
                    </div>
                    <div>
                        <label for="subject" class="block text-sm font-medium text-gray-700">Subject</label>
                        <input type="text" name="subject" id="subject" required 
                               class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500">
                    </div>
                    <div>
                        <label for="message" class="block text-sm font-medium text-gray-700">Message</label>
                        <textarea name="message" id="message" rows="4" required 
                                  class="mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500"></textarea>
                    </div>
                </div>
                <div class="mt-6 flex justify-end space-x-3">
                    <button type="button" onclick="closeContactModal()" 
                            class="bg-gray-300 hover:bg-gray-400 text-gray-700 px-4 py-2 rounded-md">
                        Cancel
                    </button>
                    <button type="submit" class="bg-primary-600 hover:bg-primary-700 text-white px-4 py-2 rounded-md">
                        Send Message
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>

<script>
function openContactModal() {
    document.getElementById('contactModal').classList.remove('hidden');
}

function closeContactModal() {
    document.getElementById('contactModal').classList.add('hidden');
}

// Close modal when clicking outside
document.getElementById('contactModal').addEventListener('click', function(e) {
    if (e.target === this) {
        closeContactModal();
    }
});
</script>
{% endblock %} 